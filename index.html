<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PANZ ‚Äî Streetwear</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
      color: #fff;
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
    }

    .container {
      padding: 20px;
    }

    h1 {
      text-align: center;
      font-size: 28px;
      margin-top: 30px;
      letter-spacing: 1px;
    }

    .collections, .products, .product-detail, .cart, .delivery {
      display: none;
    }

    .active {
      display: block;
    }

    .collection-card, .product-card {
      background: #111;
      border-radius: 12px;
      padding: 15px;
      margin: 10px 0;
      cursor: pointer;
      transition: transform 0.3s ease, background 0.3s ease;
    }

    .collection-card:hover, .product-card:hover {
      transform: translateY(-5px);
      background: #1a1a1a;
    }

    .collection-card h3, .product-card h3 {
      margin: 0;
      font-size: 18px;
    }

    .product-card img {
      width: 100%;
      border-radius: 8px;
    }

    .btn {
      background: #fff;
      color: #000;
      border: none;
      padding: 12px 20px;
      border-radius: 30px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
      width: 100%;
    }

    .btn:hover {
      background: #aaa;
    }

    .back-btn {
      background: transparent;
      color: #fff;
      border: 1px solid #fff;
      padding: 10px;
      border-radius: 30px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    .back-btn:hover {
      background: #333;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #333;
    }

    .total {
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div id="home" class="collections active">
      <h1>PANZ</h1>
      <p style="text-align:center; color:#888;">Streetwear</p>

      <div class="collection-card" onclick="showCollection('001')">
        <h3>001: Black</h3>
        <p>–ö–æ–ª–ª–µ–∫—Ü–∏—è —á—ë—Ä–Ω–æ–π –æ–¥–µ–∂–¥—ã</p>
      </div>

      <div class="collection-card" onclick="showCollection('002')">
        <h3>002: White</h3>
        <p>–ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–≤–µ—Ç–ª–æ–π –æ–¥–µ–∂–¥—ã</p>
      </div>
      
      <button class="btn" onclick="showCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ -->
    <div id="collection" class="products">
      <button class="back-btn" onclick="showHome()">‚Üê –ù–∞–∑–∞–¥</button>
      <h1 id="collection-title">–ö–æ–ª–ª–µ–∫—Ü–∏—è</h1>
      <div id="product-list"></div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞ -->
    <div id="product" class="product-detail">
      <button class="back-btn" onclick="showCollection(currentCollectionId)">‚Üê –ù–∞–∑–∞–¥</button>
      <div id="product-content"></div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="cart" class="cart">
      <button class="back-btn" onclick="showHome()">‚Üê –ù–∞–∑–∞–¥</button>
      <h1>–ö–æ—Ä–∑–∏–Ω–∞</h1>
      <div id="cart-items"></div>
      <div class="total">–ò—Ç–æ–≥–æ: <span id="total-price">0</span> ‚ÇΩ</div>
      <button class="btn" onclick="showDelivery()">–î–æ—Å—Ç–∞–≤–∫–∞</button>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ -->
    <div id="delivery" class="delivery">
      <button class="back-btn" onclick="showCart()">‚Üê –ù–∞–∑–∞–¥</button>
      <h1>–î–æ—Å—Ç–∞–≤–∫–∞</h1>
      <input type="text" id="city-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥">
      <button class="btn" onclick="getCities()">–ù–∞–π—Ç–∏ –≥–æ—Ä–æ–¥</button>
      <div id="city-results"></div>
      <div id="tariffs" style="display:none;">
        <h3>–¢–∞—Ä–∏—Ñ—ã –¥–æ—Å—Ç–∞–≤–∫–∏:</h3>
        <div id="tariff-list"></div>
        <button class="btn" onclick="selectDelivery()">–í—ã–±—Ä–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É</button>
      </div>
    </div>
  </div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    let currentCollectionId = '';
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let selectedCity = null;
    let selectedTariff = null;
    let tariffs = [];

    function showHome() {
      document.getElementById('home').classList.add('active');
      document.getElementById('collection').classList.remove('active');
      document.getElementById('product').classList.remove('active');
      document.getElementById('cart').classList.remove('active');
      document.getElementById('delivery').classList.remove('active');
    }

    function showCollection(id) {
      currentCollectionId = id;
      document.getElementById('home').classList.remove('active');
      document.getElementById('collection').classList.add('active');
      document.getElementById('product').classList.remove('active');
      document.getElementById('cart').classList.remove('active');
      document.getElementById('delivery').classList.remove('active');

      const title = document.getElementById('collection-title');
      title.textContent = `–ö–æ–ª–ª–µ–∫—Ü–∏—è ${id}`;

      const productList = document.getElementById('product-list');
      productList.innerHTML = '';

      const products = {
        '001': [
          { id: 1, name: 'T-shirt', price: 300, img: '001 T-shirt.png' },
          { id: 2, name: 'Hoodie', price: 1500, img: '001 Hoodies.png' },
          { id: 3, name: 'Beanie', price: 250, img: '001 Beanie.png'}
        ],
        '002': [
          { id: 4, name: 'T-shirt', price: 300, img: '002 T-shirt.png' },
          { id: 5, name: 'Hoodie', price: 1500, img: '002 Hoodies.png' },
          { id: 6, name: 'Beanie', price: 250, img: '002 Beanie.png'}
        ]
      };

      const collection = products[id] || [];

      collection.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.onclick = () => showProduct(p);
        card.innerHTML = `
          <img src="${p.img}" alt="${p.name}">
          <h3>${p.name}</h3>
          <p>${p.price} ‚ÇΩ</p>
        `;
        productList.appendChild(card);
      });
    }

    function showProduct(product) {
      document.getElementById('collection').classList.remove('active');
      document.getElementById('product').classList.add('active');

      const content = document.getElementById('product-content');
      content.innerHTML = `
        <img src="${product.img}" alt="${product.name}" style="width:100%;border-radius:12px;">
        <h2>${product.name}</h2>
        <p style="font-size:20px;color:#fff;">${product.price} ‚ÇΩ</p>
        <p>–û–ø–∏—Å–∞–Ω–∏–µ: –ß—ë—Ä–Ω–∞—è –æ–≤–µ—Ä—Å–∞–π–∑-—Ñ—É—Ç–±–æ–ª–∫–∞. –ü—Ä–æ—Å—Ç–æ. –°–≤–æ–±–æ–¥–Ω–æ..</p>
        <button class="btn" onclick="addToCart(${product.id}, '${product.name}', ${product.price})">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
      `;
    }

    function addToCart(id, name, price) {
      const item = cart.find(item => item.id === id);
      if (item) {
        item.quantity++;
      } else {
        cart.push({ id, name, price, quantity: 1 });
      }
      localStorage.setItem('cart', JSON.stringify(cart));
      alert(`${name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É`);
    }

    function showCart() {
      document.getElementById('home').classList.remove('active');
      document.getElementById('collection').classList.remove('active');
      document.getElementById('product').classList.remove('active');
      document.getElementById('cart').classList.add('active');

      const cartItems = document.getElementById('cart-items');
      cartItems.innerHTML = '';

      let total = 0;

      if (cart.length === 0) {
        cartItems.innerHTML = '<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
      } else {
        cart.forEach(item => {
          const itemTotal = item.price * item.quantity;
          total += itemTotal;
          const div = document.createElement('div');
          div.className = 'cart-item';
          div.innerHTML = `
            <span>${item.name} x ${item.quantity}</span>
            <span>${itemTotal} ‚ÇΩ</span>
          `;
          cartItems.appendChild(div);
        });
      }

      document.getElementById('total-price').textContent = total;
    }

    function showDelivery() {
      if (cart.length === 0) {
        alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
        return;
      }

      document.getElementById('cart').classList.remove('active');
      document.getElementById('delivery').classList.add('active');
    }

    function getCities() {
      const city = document.getElementById('city-input').value;
      fetch('https://your-backend-url.com/cdek/cities?q=' + encodeURIComponent(city))
        .then(response => response.json())
        .then(data => {
          const results = document.getElementById('city-results');
          results.innerHTML = '';
          data.forEach(c => {
            const div = document.createElement('div');
            div.onclick = () => {
              selectedCity = c;
              results.innerHTML = `<p>–í—ã–±—Ä–∞–Ω: ${c.city}</p>`;
              getTariffs(c.code);
            };
            div.textContent = `${c.city}, ${c.region}`;
            results.appendChild(div);
          });
        });
    }

    function getTariffs(cityCode) {
      fetch('https://your-backend-url.com/cdek/calculate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cityCode, items: cart })
      })
      .then(response => response.json())
      .then(data => {
        tariffs = data;
        const tariffList = document.getElementById('tariff-list');
        tariffList.innerHTML = '';
        data.forEach(t => {
          const div = document.createElement('div');
          div.innerHTML = `${t.tariff_name} ‚Äî ${t.price} ‚ÇΩ (${t.delivery_period_min}-${t.delivery_period_max} –¥–Ω–µ–π)`;
          div.onclick = () => {
            selectedTariff = t;
            div.style.background = '#333';
          };
          tariffList.appendChild(div);
        });
        document.getElementById('tariffs').style.display = 'block';
      });
    }

    function selectDelivery() {
      if (!selectedTariff) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –¥–æ—Å—Ç–∞–≤–∫–∏');
        return;
      }

      const total = parseInt(document.getElementById('total-price').textContent) + selectedTariff.price;

      const orderData = {
        userId: Telegram.WebApp.initDataUnsafe.user?.id || 'guest',
        items: cart,
        total: total,
        delivery: {
          city: selectedCity.city,
          tariff: selectedTariff.tariff_name,
          price: selectedTariff.price,
          period: `${selectedTariff.delivery_period_min}-${selectedTariff.delivery_period_max} –¥–Ω–µ–π`
        }
      };

      fetch('https://your-backend-url.com/create-order', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(orderData)
      })
      .then(response => response.json())
      .then(data => {
        alert('–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω! –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–ø–ª–∞—Ç—É...');
        Telegram.WebApp.openInvoice(data.paymentUrl);
      });
    }
  </script>
</body>

</html>




